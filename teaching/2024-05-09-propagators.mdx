---
title: Wavefront Propagation
author: Yuri R. Tonin
author_title: Physics Engineer
author_url: https://github.com/yurirt94
author_image_url: /img/me.jpg
tags: [propagation, nearfield, fresnel]
description: description
image: /img/hunte.png
hide_table_of_contents: false
---

import Figure from '../src/components/figure';
import SEO from '../src/components/seo';
import Reminder from '../src/components/reminder';


*This post intends to be a quick guide on the most important equations for computing free space propagation of a wavefront in the Fresnel regime, and how to do it properly.*

### Helmholtz equation and elementary waves

First, some background. Consider a monochromatic wave $\psi$ in vacuum. It is governed by Helmholtz equation:
$$
\nabla^2\psi + k^2 \psi = 0 
$$

which has two solutions which we call elementary waves. These are: 

Plane Waves

$$
\psi(\mathbf{r}) = A \exp{(-j \mathbf{k} \cdot \mathbf{r})} = A \exp{[-j (k_x x + k_y y + k_z z)]}
$$

Spherical Waves
$$
\psi(\mathbf{r}) = \frac{A}{r} \exp{(-j k r)} 
$$
which names indicates that the wavefronts (i.e. the surfaces of constant phase) are either planes or spheres. These are the most basic waves there are. Keep in mind that spherical waves are the kind of wave produced by point sources.

Naturally, what we encounter waves that are way more complex than elementary waves. Luckily, we can make things easier by what is called the **Angular Spectrum** of waves.

### Angular Spectrum Method (ASM)

An arbitrary wavefront $U_1(x,y)$ can be decomposed into plane wave components:

### Raleigh-Sommerfeld Diffraction

$$
U_2(x_2,y_2) = \frac{z}{j \lambda} \int \int_S U_1(x_1,y_1) \frac{\exp{(j k r_{12})}}{r_{12}^2} dx_1 dy_1
$$
where
$$
r_{12} = \sqrt{z^2 + (x_2 - x_1)^2 + (y_2 - y_1)^2}
$$

<a >
    <Figure 
      data={{
            src: 'https://upload.wikimedia.org/wikipedia/commons/a/a2/Diffraction_geometry.svg',
            alt: 'propagationplanes',
            type: 'image'
      }} 
    />
    <figcaption align = "center"><b> Source plane located at $0$ and target plane at position $z$.</b></figcaption>
  <br/>
</a>

### Approximations

Paraboloidal

$$
U(x_2,y_2) = \frac{e^{ikL}}{i \lambda L} \int \int_{-\infty}^{+\infty} U (x_1,y_1) e^{ \frac{i k}{2 L}\left[{(x_2-x_1)^2+(y_2-y_1)^2} \right]} dx_1 dy_1
$$

Gaussian

$$
A = 1
$$


### Calculation of the Fresnel diffraction integral

Expanding

$$
U(x_2,y_2) = \frac{e^{ikL}}{i \lambda L} e^{ \frac{i k}{2 L}\left[{x_2^2+y_2^2} \right]} \int \int_{-\infty}^{+\infty} U (x_1,y_1) e^{ \frac{i k}{2 L} \left[{x_1^2+y_1^2} \right] } e^{ \frac{i k}{2 L}{(x_2 x_1+y_2 y_1)} }dx_1 dy_1
$$

#### Impulse Response (IR)

Equation XXX is nothing more than a convolution of $U$ with the following impulse responde function $h$

$$
    h(x,y) =  \frac{e^{ikz}}{i \lambda z} e^{ \frac{i k}{2 z}\left[{x^2+y^2} \right]}
$$

This convolution can be calculated in Fourier space as 

$$
    U(x_2,y_2) = \mathcal{F}^{-1}{ \mathcal{F}{ U(x_1,y_1) } H(f_{x1},f_{y1}) }
$$
where
$$
    H(f_{x1},f_{y1}) = \mathcal{F}{h(x_1,y_1)} = e^{jkz} \exp{[j \pi \lambda z (f_{x}^2+f_{y}^2)]}
$$

#### Single Fourier Transform (SFT) 

$$
    U(x_2,y_2) = \frac{e^{ikz}}{i \lambda z} e^{ \frac{i k}{2 z}\left[{x_2^2+y_2^2} \right]} \mathcal{F}{ U(x_1,y_1) e^{ \frac{i k}{2 z} \left[{x_1^2+y_1^2} \right] } }
$$

Although mathematically identical, they are numerically different.

Chirp functions:

$$
C_1 = e^{ \frac{i k}{2 z} \left({x_1^2+y_1^2} \right) } 
$$

$$
C_2 = e^{j \pi \lambda z (f_{x}^2+f_{y}^2)}
$$

### When to use which?

Now, to the practical side: how do you choose which to use? In that case one may use a rule of thumb (although for the details I'd recommend taking a close look at the references below):

| Criteria      | Sampling    | Comment     |
| -----------   | ----------- | ----------- |
| $\Delta x > \frac{\lambda z}{L}$ | TF: oversampled. IR: undersampled | IR method causes periodic copies. TF is the method of choice. Observation plane width will be limited to width $D + \lambda z / \Delta x$|
| $\Delta x = \frac{\lambda z}{L}$ | both TF and IR: critical sampling | TF and IR are identical |
| $\Delta x < \frac{\lambda z}{L}$ | TF: undersampled. IR: oversampled | It depends. Needs to evaluate if source bandwidth satisfies $B \le \frac{L}{2 \lambda z}$. If yes, use TF. Otherwise, IR may be better. |

### Fresnel scaling theorem

What if you have a point source (i.e. spherical waves), causing the beam to diverge?



### The 2-step Fresnel propagator



$$
\begin{align*}
U(x_2,y_2)  & = \frac{L_2}{L_1} \exp{(j k z)} \exp{\left[ -j \frac{k}{2z} \frac{L_1-L_2}{L_2} (x_2^2+y_2^2)  \right]} 
\\ & \mathcal{F}^{-1}{\exp{[-j\pi \lambda z \frac{L_1}{L_2}(f_{x1}^2+f_{y1}^2)]}  \mathcal{F}{ U_1(x_1,y_1) \exp{[j \frac{k}{2z}\frac{L_1-L_2}{L_1}(x_1^2+y_1^2)]}} }
\end{align*}
$$


### References ###

  - Saleh, B. E. A., & Teich, M. C. (1991). Fundamentals of Photonics. Wiley. https://doi.org/10.1002/0471213748
  - Paganin, David, Coherent X-Ray Optics, Oxford Series on Synchrotron Radiation (2006), https://doi.org/10.1093/acprof:oso/9780198567288.001.0001
  - Goodman, J. W., & Cox, M. E. (1969). Introduction to Fourier Optics. 
  - Voelz, D. G. (2011). Computational Fourier Optics: A MATLAB Tutorial. SPIE. https://doi.org/10.1117/3.858456
  - Schmidt, J. D. (2010). Numerical Simulation of Optical Wave Propagation with Examples in MATLAB. SPIE. https://doi.org/10.1117/3.866274


<!--truncate-->

<SEO
  uri='blog/name'
  image='img/template.jpg'
  type='article'
/>



